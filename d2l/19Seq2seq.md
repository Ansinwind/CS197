# Seq2seq 序列到序列



## eg 机器翻译



- 编码器是一个RNN，读取输入句子
  - 可以双向
- 解码器使用另外一个RNN来输出



- 编码器是没有输出的RNN
- 编码器最后时间步的隐状态用作解码器的初始隐状态



## 衡量生成序列的好坏的BLEU

- $p_n$是预测中所有n元组的精度
- BLEU：

$$
\exp(\min(0,1-\frac{len_{label}}{len_{pred}}))\Pi_{n=1}^kp_n^{\frac{1}{2^n}}
$$

- Seq2seq从一个句子生成另一个句子
- 编码器和解码器都是RNN
- 将编码器最后时间隐状态来初始解码器隐状态来完成信息传递
- 常用BLEU来衡量生成序列的好坏



## 使用注意力机制的seq2seq

- 编码器对每次词的输出作为key和value
- 解码器RNN对上一个词的输出是query
- 注意力的输出和下一个词的词嵌入合并进入